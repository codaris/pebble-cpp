<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pebble Foundation Classes: PBI File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pebble Foundation Classes
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">C++ for Pebble</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__PBIFileFormat.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PBI File Format<div class="ingroups"><a class="el" href="group__Foundation.html">Foundation</a> &raquo; <a class="el" href="group__Resources.html">Resources</a> &raquo; <a class="el" href="group__FileFormats.html">File Formats</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for PBI File Format:</div>
<div class="dyncontent">
<div class="center"><img src="group__PBIFileFormat.png" border="0" usemap="#group____PBIFileFormat" alt=""/></div>
<map name="group____PBIFileFormat" id="group____PBIFileFormat">
<area shape="rect" href="group__FileFormats.html" title=" " alt="" coords="5,5,108,31"/>
<area shape="rect" title=" " alt="" coords="156,5,276,31"/>
</map>
</div>
<p>PBIs are uncompressed bitmap images with support for color-mapping palettes. PBIs store images either as raw image pixels (1-bit black and white, or 8-bit ARGB) or as palette-based images with 1, 2, or 4 bits per pixel. For palette-based images the pixel data represents the index into the palette, such that each pixel only needs to be large enough to represent the palette size, so </p><ul>
<li><code>1-bit</code> supports up to 2 colors, </li>
<li><code>2-bit</code> supports up to 4 colors, </li>
<li><code>4-bit</code> supports up to 16 colors.</li>
</ul>
<p>The metadata describes how long each row of pixels is in the buffer (the stride). The following restrictions on stride are in place for different formats:</p>
<ul>
<li>GBitmapFormat1Bit: Each row must be a multiple of 32 pixels (4 bytes). Using the <code>bounds</code> field, the area that is actually relevant can be specified. For example, when the image is 29 by 5 pixels (width by height) and the first bit of image data is the pixel at (0, 0), then the bounds.size would be <code><a class="el" href="group__GraphicsTypes.html#ga71761014e71575ac39edc38709cc048b" title="Convenience macro to make a GSize.">GSize(29, 5)</a></code> and bounds.origin would be <code><a class="el" href="group__GraphicsTypes.html#gabf9cee451faac8ad07157b775b951699" title="Convenience macro to make a GPoint.">GPoint(0, 0)</a></code>. <img src="gbitmap.png" alt="" class="inline"/> In the illustration each pixel is a representated as a square. The white squares are the bits that are used, the gray squares are the padding bits, because each row of image data has to be a multiple of 4 bytes (32 bits). The numbers in the column in the left are the offsets (in bytes) from the <code>*addr</code> field of the GBitmap. Each pixel in a bitmap is represented by 1 bit. If a bit is set (<code>1</code> or <code>true</code>), it will result in a white pixel, and vice versa, if a bit is cleared (<code>0</code> or <code>false</code>), it will result in a black pixel. <img src="pixel_bit_values.png" alt="" class="inline"/></li>
<li>GBitmapFormat8Bit: Each pixel in the bitmap is represented by 1 byte. The color value of that byte correspends to a GColor.argb value. There is no restriction on row_size_bytes / stride.</li>
<li>GBitmapFormat1BitPalette, GBitmapFormat2BitPalette, GBitmapFormat4BitPalette: Each pixel in the bitmap is represented by the number of bits the format specifies. Pixels must be packed. For example, in GBitmapFormat2BitPalette, each pixel uses 2 bits. This means 4 pixels / byte. Rows need to be byte-aligned, meaning that there can be up to 3 unused pixels at the end of each line. If the image is 5 pixels wide and 4 pixels tall, row_size_bytes = 2, and each row in the bitmap must take 2 bytes, so the bitmap data is 8 bytes in total.</li>
</ul>
<p>Palettized bitmaps also need to have a palette. The palette must be of the correct size, which is specified by the format. For example, GBitmapFormat4BitPalette uses 4 bits per pixel, meaning that there must be 2^4 = 16 colors in the palette.</p>
<p>The Basalt Platform provides for 2-bits per color channel, so images are optimized by the SDK tooling when loaded as a resource-type "pbi" to the Pebble's 64-colors with 4 levels of transparency. This optimization also handles mapping unsupported colors to the nearest supported color, and reducing the pixel depth to the number of bits required to support the optimized number of colors.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__GraphicsTypes.html#ga0c01fd1816c6c0fde05310141f293cc5">gbitmap_create_with_data</a> </dd>
<dd>
<a class="el" href="group__GraphicsTypes.html#gae1c7c90641f5138b5f36f9334d52085a">gbitmap_create_with_resource</a> </dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
