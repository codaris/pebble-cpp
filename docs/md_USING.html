<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pebble Foundation Classes: Using this SDK</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pebble Foundation Classes
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">C++ for Pebble</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_USING.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using this SDK </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md13"></a>
Installing the Package</h1>
<p>Add the Pebble Foundation Classes package to your project using the following command:</p>
<div class="fragment"><div class="line">&gt; pebble package install pebble-cpp</div>
<div class="line">&gt; pebble build</div>
</div><!-- fragment --><p>The build step will unpack the files in the package so when can reference them.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Updating the wscript file</h1>
<p>The <code>wscript</code> file located in the project root contains the instructions for the Pebble build system to compile the source files. This file needs to be modified to add commands to build C++ <code>*.cpp</code> files. <br  />
</p>
<p>You can copy an updated version of this file from the package folder <code>node_modules/pebble-cpp/dist/include/pebble-cpp/wscript</code>. Execute the following command in the root of your project to copy this file over the existing <code>wscript</code> file.</p>
<div class="fragment"><div class="line">&gt; cp node_modules/pebble-cpp/dist/include/pebble-cpp/wscript .</div>
</div><!-- fragment --><p>Alternatively you can view and download the updated <code>wscript</code> file from <a href="https://raw.githubusercontent.com/codaris/pebble-cpp/main/include/wscript">here</a>.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Structure of Source files</h1>
<p>In order for your C++ code to be compiled by the C++ compiler they must have the <code>.cpp</code> file extension. You can freely mix C <code>.c</code> and C++ <code>.cpp</code> files in your projects. Although it's recommended that all your files be <code>.cpp</code> files &ndash; you have full access to all Pebble SDK C functions in C++ files.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
The entry point</h2>
<p>In order for Pebble to be able to build your project, it must have a main() function. In C++ files, this main function must be declared <code>extern "C"</code> so the full entry point looks like this:</p>
<div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) </div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Your initialization code here</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run the event loop</span></div>
<div class="line">    <a class="code" href="group__App.html#ga76a67379592a1844028767ee20332730">app_event_loop</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
The &lt;Pebble.hpp&gt; header</h2>
<p>In C++ files, you do not include the <code>&lt;<a class="el" href="pebble_8h_source.html">pebble.h</a>&gt;</code> header. Instead you include the Pebble Foundation Classes header from the pebble-cpp package <code>&lt;pebble-cpp/pebble.hpp&gt;</code>. This header also includes <code>&lt;<a class="el" href="pebble_8h_source.html">pebble.h</a>&gt;</code> automatically giving you full access to all the Pebble SDK functions.</p>
<p>Since all the classes are in the <code>Pebble</code> namespace you can add <code>using namespace Pebble;</code> to make all the types available without needing the <code>Pebble::</code> prefix.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;pebble-cpp/pebble.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>Pebble;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md18"></a>
The AppWindow class</h1>
<p>To create a window in your pebble application you should subclass the <code>AppWindow</code> class. This class has 4 virtual methods that you can override to manage the state of the Window:</p>
<div class="fragment"><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> OnLoad() { }; </div>
<div class="line"> </div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> OnUnload() { }; </div>
<div class="line"> </div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> OnAppear() { }; </div>
<div class="line"> </div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> OnDisappear() { }; </div>
</div><!-- fragment --><p>Every <code>AppWindow</code> subclass should at least override the <code>OnLoad</code> handler to setup the window and any layers contained within it.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Using Callbacks</h1>
<p>The Pebble C API uses callbacks to provide functionality. In the C API, you provide a function pointer that gets called when the Pebble OS needs to signal your code. In Pebble Foundation Classes, this works in a similar way except you can provide methods instead of functions and the context parameter is handled automatically. This greatly simplies managing callbacks.</p>
<p>To use a callback in your classes, you need to use the <code>CALLBACK</code> macro. This macro takes either a single method name as a parameter and returns a callback function. You use this macro whenever you need to generate a callback to a method:</p>
<p>See the following class for an example:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MainWindow : <span class="keyword">public</span> AppWindow</div>
<div class="line">{</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> OnLoad()</div>
<div class="line">    {</div>
<div class="line">        SetClickConfigProvider(CALLBACK(OnClickConfig));</div>
<div class="line">        textLayer.SetFrame(0, 55, 144, 50);</div>
<div class="line">        textLayer.SetBackgroundColor(GColorClear);</div>
<div class="line">        textLayer.SetTextColor(<a class="code" href="group__ColorDefinitions.html#ga03d3c53a6a31fe2d80def95b8c035e26">GColorBlack</a>);</div>
<div class="line">        textLayer.SetFont(FONT_KEY_BITHAM_42_BOLD);</div>
<div class="line">        textLayer.SetTextAlignment(<a class="code" href="group__TextDrawing.html#gga12cbd02b0d5668d7c9bd582077bf7f1da96946af7ae1aa2183ff953e0b053b79a">GTextAlignmentCenter</a>);</div>
<div class="line">        AddChild(textLayer);</div>
<div class="line">    }        </div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> OnClickConfig(<span class="keyword">const</span> ClickConfig&amp; clickConfig)</div>
<div class="line">    { </div>
<div class="line">        clickConfig.SingleClick(<a class="code" href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266ea98093cd31c917223780131cfafe91dec">BUTTON_ID_SELECT</a>, CALLBACK(OnSelectClick));</div>
<div class="line">        clickConfig.SingleClick(<a class="code" href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266eafb03cb7921a8bb7893cd8093a1a5e9cb">BUTTON_ID_UP</a>, CALLBACK(OnUpClick));</div>
<div class="line">        clickConfig.SingleClick(<a class="code" href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266ea65a919b8a0f4539acfb865eb2a2dd9d0">BUTTON_ID_DOWN</a>, CALLBACK(OnDownClick));</div>
<div class="line">    }    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> OnSelectClick(<span class="keyword">const</span> ClickRecognizer&amp; recognizer)</div>
<div class="line">    {</div>
<div class="line">        textLayer.SetText(<span class="stringliteral">&quot;Select&quot;</span>);</div>
<div class="line">    }    </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> OnDownClick(<span class="keyword">const</span> ClickRecognizer&amp; recognizer)</div>
<div class="line">    {</div>
<div class="line">        textLayer.SetText(<span class="stringliteral">&quot;Down&quot;</span>);</div>
<div class="line">    }    </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> OnUpClick(<span class="keyword">const</span> ClickRecognizer&amp; recognizer)</div>
<div class="line">    {</div>
<div class="line">        textLayer.SetText(<span class="stringliteral">&quot;Up&quot;</span>);</div>
<div class="line">    }    </div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code" href="classPebble_1_1TextLayer.html">Pebble::TextLayer</a> textLayer;   </div>
<div class="line">};</div>
</div><!-- fragment --><p>This class demonstrates how the <code>CALLBACK</code> macro is used to set the <code>ClickConfigProvider</code> for the window. It is used again in <code>OnClickConfig</code> method to set the various click event handlers.</p>
<p>The library automatically handles managing the context pointer so that these callbacks are routed to your window instance. You must use the correct types for the callback methods or you will get a build error.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
The TickTimer class</h1>
<p>The <code>TickTimer</code> class is a fundamental class for watch faces. It was what provides the tick events for updating the time on the display. This class is meant to be subclassed and provides an <code>OnTick</code> method that you need to override. <br  />
</p>
<p>See the following class for an example:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MainWindow : <span class="keyword">public</span> AppWindow, <span class="keyword">public</span> TickTimer</div>
<div class="line">{</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> OnLoad()</div>
<div class="line">    {</div>
<div class="line">        textLayer.SetFrame(0, 55, 144, 50);</div>
<div class="line">        textLayer.SetBackgroundColor(GColorClear);</div>
<div class="line">        textLayer.SetTextColor(<a class="code" href="group__ColorDefinitions.html#ga03d3c53a6a31fe2d80def95b8c035e26">GColorBlack</a>);</div>
<div class="line">        textLayer.SetFont(FONT_KEY_BITHAM_42_BOLD);</div>
<div class="line">        textLayer.SetTextAlignment(<a class="code" href="group__TextDrawing.html#gga12cbd02b0d5668d7c9bd582077bf7f1da96946af7ae1aa2183ff953e0b053b79a">GTextAlignmentCenter</a>);</div>
<div class="line">        AddChild(textLayer);</div>
<div class="line">        TickTimerStart(<a class="code" href="group__TickTimerService.html#gga0423d00e0eb199de523a92031b5a1107af135dc6b67dce70c7b4b961605aa6970">MINUTE_UNIT</a>);</div>
<div class="line">        UpdateTime();</div>
<div class="line">    }        </div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> UpdateTime()</div>
<div class="line">    {</div>
<div class="line">        DateTime date = DateTime::Now();    </div>
<div class="line">        <span class="comment">// Use 24 hour format</span></div>
<div class="line">        date.Format(buffer, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;00:00&quot;</span>), <span class="stringliteral">&quot;%H:%M&quot;</span>);</div>
<div class="line">        textLayer.SetText(buffer);</div>
<div class="line">    }    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> OnTick(<a class="code" href="structtm.html">tm</a> &amp;tick_time, <a class="code" href="group__TickTimerService.html#ga0423d00e0eb199de523a92031b5a1107">TimeUnits</a> units_changed)</div>
<div class="line">    {</div>
<div class="line">        UpdateTime();</div>
<div class="line">    }    </div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">char</span> buffer[5];</div>
<div class="line">    <a class="code" href="classPebble_1_1TextLayer.html">Pebble::TextLayer</a> textLayer;   </div>
<div class="line">};</div>
</div><!-- fragment --><p>This class creates a <code>TextLayer</code> to hold the time and then starts the timer. Every minute, the OnTick() method is called and the time is updated on the display. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__App_html_ga76a67379592a1844028767ee20332730"><div class="ttname"><a href="group__App.html#ga76a67379592a1844028767ee20332730">app_event_loop</a></div><div class="ttdeci">void app_event_loop(void)</div></div>
<div class="ttc" id="agroup__TickTimerService_html_ga0423d00e0eb199de523a92031b5a1107"><div class="ttname"><a href="group__TickTimerService.html#ga0423d00e0eb199de523a92031b5a1107">TimeUnits</a></div><div class="ttdeci">TimeUnits</div><div class="ttdef"><b>Definition:</b> pebble.h:815</div></div>
<div class="ttc" id="aclassPebble_1_1TextLayer_html"><div class="ttname"><a href="classPebble_1_1TextLayer.html">Pebble::TextLayer</a></div><div class="ttdef"><b>Definition:</b> pebble_text_layer.hpp:5</div></div>
<div class="ttc" id="agroup__Clicks_html_ggaa60e15d86cfe7033f28c7d066c85266eafb03cb7921a8bb7893cd8093a1a5e9cb"><div class="ttname"><a href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266eafb03cb7921a8bb7893cd8093a1a5e9cb">BUTTON_ID_UP</a></div><div class="ttdeci">@ BUTTON_ID_UP</div><div class="ttdoc">Up button.</div><div class="ttdef"><b>Definition:</b> pebble.h:164</div></div>
<div class="ttc" id="astructtm_html"><div class="ttname"><a href="structtm.html">tm</a></div><div class="ttdef"><b>Definition:</b> pebble.h:8311</div></div>
<div class="ttc" id="agroup__ColorDefinitions_html_ga03d3c53a6a31fe2d80def95b8c035e26"><div class="ttname"><a href="group__ColorDefinitions.html#ga03d3c53a6a31fe2d80def95b8c035e26">GColorBlack</a></div><div class="ttdeci">#define GColorBlack</div><div class="ttdoc">GColorBlack</div><div class="ttdef"><b>Definition:</b> gcolor_definitions.h:113</div></div>
<div class="ttc" id="agroup__Clicks_html_ggaa60e15d86cfe7033f28c7d066c85266ea98093cd31c917223780131cfafe91dec"><div class="ttname"><a href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266ea98093cd31c917223780131cfafe91dec">BUTTON_ID_SELECT</a></div><div class="ttdeci">@ BUTTON_ID_SELECT</div><div class="ttdoc">Select (middle) button.</div><div class="ttdef"><b>Definition:</b> pebble.h:166</div></div>
<div class="ttc" id="agroup__TickTimerService_html_gga0423d00e0eb199de523a92031b5a1107af135dc6b67dce70c7b4b961605aa6970"><div class="ttname"><a href="group__TickTimerService.html#gga0423d00e0eb199de523a92031b5a1107af135dc6b67dce70c7b4b961605aa6970">MINUTE_UNIT</a></div><div class="ttdeci">@ MINUTE_UNIT</div><div class="ttdoc">Flag to represent the &quot;minutes&quot; time unit.</div><div class="ttdef"><b>Definition:</b> pebble.h:819</div></div>
<div class="ttc" id="agroup__Clicks_html_ggaa60e15d86cfe7033f28c7d066c85266ea65a919b8a0f4539acfb865eb2a2dd9d0"><div class="ttname"><a href="group__Clicks.html#ggaa60e15d86cfe7033f28c7d066c85266ea65a919b8a0f4539acfb865eb2a2dd9d0">BUTTON_ID_DOWN</a></div><div class="ttdeci">@ BUTTON_ID_DOWN</div><div class="ttdoc">Down button.</div><div class="ttdef"><b>Definition:</b> pebble.h:168</div></div>
<div class="ttc" id="agroup__TextDrawing_html_gga12cbd02b0d5668d7c9bd582077bf7f1da96946af7ae1aa2183ff953e0b053b79a"><div class="ttname"><a href="group__TextDrawing.html#gga12cbd02b0d5668d7c9bd582077bf7f1da96946af7ae1aa2183ff953e0b053b79a">GTextAlignmentCenter</a></div><div class="ttdeci">@ GTextAlignmentCenter</div><div class="ttdoc">Aligns the text centered inside the drawing box.</div><div class="ttdef"><b>Definition:</b> pebble.h:4680</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
